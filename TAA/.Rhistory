matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(12,16.5,12,6), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(12,16.5,17,19), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(2,6.5,17,19), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(2,6.5,7,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(2,2.5,7,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(0,0,0,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(0,0,0,0), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(6,7,8,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(3,5,7,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(9,9,9,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(8,9,9,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(0,8,9,9,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(8,9,9,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(8,9.5,11,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(8,9.5,11,11), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(8,9.5,11,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(0,9.5,11,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,9.5,11,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,7.5,11,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,11.5,11,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,13,11,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,13,15,15), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,13,15,9), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,13,15,19), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,13,19,14), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,11,19,14), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
text.width=c(10,11,20,14), cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,20,14), box.lty = 0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,20,14), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,14), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,14), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,1), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,10), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
colnames(error.table)=c("Error Cart","Error Bagging",
"Error Rand. Forest","Error SVM")
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
colnames(error.table)=c("Error Cart","Error Bagging",
"Error R. Forest","Error SVM")
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12), box.lty=0, bty="n",
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12), box.lty=0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,box.lty=0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,xjust=0,yjust=0,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12),box.lty=0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12),box.lty=0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
colnames(error.table)=c("Error Cart","Error Bagging",
"Error R. Forest","Error SVM")
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,
cex=.9,text.width=c(10,11,0,12),box.lty=0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
matplot(error.table,type="l",lwd=2,lty=1,col=c("red","blue","green","orange"))
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
cex=.9,text.width=c(10,11,0,12),box.lty=0,
legend=c(colnames(error.table)[1],colnames(error.table)[2],
colnames(error.table)[3],colnames(error.table)[4]),
col=c("red","blue","green","orange"),bg="white",lwd=c(2,2,2,2))
# variables para ir guardando los resultados
importance=NULL
oob=NULL
for(k in 1:25){
# generamos el random forest con mtry=k
rf=randomForest(type~.,data=train,coob=TRUE,mtry=k)
# almacenamos la importancia para este valor de k
importance=cbind(importance,rf$importance)
# almacenamos el error OOB para este valor de k
oob=cbind(oob,rf$err.rate[500,1])
}
# graficamos el error OBB con respecto al mtry
plot(1:25,oob,type="l",main="Error OOB según mtry",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# graficamos la importancia de las variables con respecto al mtry
matplot(t(importance), type="l",lwd=2,
xlab="mtry",ylab="importancia variables SPAM")
# 52,53 High - 26 46 Medium - 38 47 Low
# importance[52,7]
plot(1:25,importance[52,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[53,7]
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# importance[26,7]
plot(1:25,importance[26,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[46,7]
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[26],rownames(importance)[46]))
# importance[38,7]
plot(1:25,importance[38,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[47,7]
lines(1:25,importance[47,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[38],rownames(importance)[47]))
importance
importance[52]
importance[52,]
importance[53,]
importance[26,]
plot(1:25,importance[52,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[53,7]
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# importance[26,7]
lines(1:25,importance[26,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[46,7]
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
plot(1:25,importance[52,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[53,7]
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# importance[26,7]
lines(1:25,importance[26,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[46,7]
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[26],rownames(importance)[46]))
plot(1:25,importance[52,],type="l",ylim=c(50,250),
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[53,7]
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# importance[26,7]
plot(1:25,importance[26,],type="l",ylim=c(50,250),
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[46,7]
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[26],rownames(importance)[46]))
# importance[38,7]
plot(1:25,importance[38,],type="l",ylim=c(50,250),
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[47,7]
lines(1:25,importance[47,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[38],rownames(importance)[47]))
plot(1:25,importance[52,],type="l",ylim=c(0,250),
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[53,7]
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# importance[26,7]
plot(1:25,importance[26,],type="l",ylim=c(0,250),
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[46,7]
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[26],rownames(importance)[46]))
# importance[38,7]
plot(1:25,importance[38,],type="l",ylim=c(0,250),
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[47,7]
lines(1:25,importance[47,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[38],rownames(importance)[47]))
plot(1:25,importance[52,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[53,7]
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# importance[26,7]
plot(1:25,importance[26,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[46,7]
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[26],rownames(importance)[46]))
# importance[38,7]
plot(1:25,importance[38,],type="l",
lwd=2,col="red",xlab="mtry",ylab="error OOB")
# importance[47,7]
lines(1:25,importance[47,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="error OOB")
legend("bottom",inset=c(0,-.35),xpd=TRUE,horiz=TRUE,x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[38],rownames(importance)[47]))
matplot(t(importance), type="l",lwd=2,
xlab="mtry",ylab="importancia variables SPAM")
matplot(t(importance), type="l",lwd=2,ylim=c(-1,100),
xlab="mtry",ylab="importancia variables SPAM")
matplot(t(importance), type="l",lwd=2,ylim=c(-1,40),
xlab="mtry",ylab="importancia variables SPAM")
matplot(t(importance), type="l",lwd=2,ylim=c(-1,20),
xlab="mtry",ylab="importancia variables SPAM")
matplot(t(importance), type="l",lwd=2,ylim=c(-1,10),
xlab="mtry",ylab="importancia variables SPAM")
matplot(t(importance), type="l",lwd=2,
xlab="mtry",ylab="importancia variables SPAM")
matplot(t(importance), type="l",lwd=2,
xlab="mtry",ylab="importancia variables SPAM")
# graficas para las dos variables más importantes en el caso por defecto
plot(1:25,importance[52,],type="l",
lwd=2,col="red",xlab="mtry",ylab="importancia de la variable")
lines(1:25,importance[53,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="importancia de la variable")
legend("topleft",x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[52],rownames(importance)[53]))
# graficas para dos variables con importancia cercana al promedio de imporancias
plot(1:25,importance[26,],type="l",
lwd=2,col="red",xlab="mtry",ylab="importancia de la variable")
lines(1:25,importance[46,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="importancia de la variable")
legend("topright",x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[26],rownames(importance)[46]))
# graficas para las dos variables menos importantes en el caso por defecto
plot(1:25,importance[38,],type="l",
lwd=2,col="red",xlab="mtry",ylab="importancia de la variable")
lines(1:25,importance[47,],type="l",
lwd=2,col="blue",xlab="mtry",ylab="importancia de la variable")
legend("topright",x.intersp=0.5,
col=c("red","blue"),lwd=2,
legend=c(rownames(importance)[38],rownames(importance)[47]))
T$frame
t
T
round(T$frame)
T
T.frame
summary(T)
class(T$frame)
library(rpart)
library(rpart.plot)
library(partykit)
library(kernlab)
set.seed(2019)
data(spam)
# separamos los datos en train/test
smp_size = floor(2/3 * nrow(spam))
train_ind = sample(seq_len(nrow(spam)), size=smp_size)
train = spam[train_ind,]
test = spam[-train_ind,]
# generamos y graficamos el arbol por defecto
T=rpart(type~.,data=train)
prp(T,yesno=0)
# computamos el error en test del arbol T
T_pred=predict(T,type="class",test)
T_error=sum(T_pred!=test[,58])/dim(test)[1]
T_error
# generamos y graficamos el decision stump
DS=rpart(type~.,data=train,maxdepth=1)
prp(DS,extra=2,yesno=0)
# computamos el error en test del decision stump
DS_pred=predict(DS,type="class",test)
DS_error=sum(DS_pred!=test[,58])/dim(test)[1]
DS_error
# Analizamos T$frame
T$frame
head(T$frame)
Tt=rpart(type~.,data=train,cp=0.1)
plot(Tt)
text(Tt)
Tt=rpart(type~.,data=train,cp=0.05)
plot(Tt)
text(Tt)
T$cptable
clear
pwd
library(readr)
crew <- read_table2("/crew.tsv")
install.packages("readr")
library(readr)
crew <- read_table2("/crew.tsv")
crew <- read_table2("crew.tsv")
